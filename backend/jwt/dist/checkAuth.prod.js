"use strict";var jwt=require("jsonwebtoken");function generateToken(e){var t={id:e._id,email:e.username};return jwt.sign(t,"secret123",{expiresIn:"1h"})}function checkAuthToken(n,r,s){var e=n.headers.authorization,t=e&&e.split(" ")[1];if(null==t)return r.status(401).json({message:"Требуется авторизация"});jwt.verify(t,"secret123",function(e,t){return e?r.status(403).json({message:"invalid token"}):(n.user=t,void s())})}module.exports.checkAuthToken=checkAuthToken,module.exports.generateToken=generateToken;